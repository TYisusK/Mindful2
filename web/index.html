<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mindful+</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#5B4BDB" />

  <!-- Icons -->
  <link rel="icon" sizes="192x192" href="/icons/log192.png" />
  <link rel="apple-touch-icon" href="/icons/log192.png" />

  <style>
    html,body{height:100%;margin:0;background:#F7F5FF;font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial;}
    .boot {display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;color:#2F224D;}
    .badge {margin-top:10px;padding:6px 10px;border-radius:999px;background:#EDE7FF;color:#5B4BDB;font-size:13px}
  </style>
</head>
<body>
  <div class="boot">
    <div style="font-weight:700;font-size:22px;">Mindful+</div>
    <div class="badge" id="net">Comprobando conexión…</div>
  </div>

  <script>
    // Registro del Service Worker
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("/service_worker.js").then((reg) => {
          // Auto-actualización si hay versión nueva
          if (reg.waiting) reg.waiting.postMessage({ type: "SKIP_WAITING" });
          reg.addEventListener("updatefound", () => {
            const nw = reg.installing;
            nw && nw.addEventListener("statechange", () => {
              if (nw.state === "installed" && navigator.serviceWorker.controller) {
                console.log("Nueva versión del SW lista.");
              }
            });
          });
        }).catch((e)=>console.warn("SW fail:",e));
      });
    }

    // Indicador básico de red
    const el = document.getElementById("net");
    function setNet() {
      el.textContent = navigator.onLine ? "Conectado" : "Sin conexión (modo offline)";
      el.style.background = navigator.onLine ? "#EDE7FF" : "#FFEADB";
      el.style.color = navigator.onLine ? "#5B4BDB" : "#8B5A00";
    }
    window.addEventListener("online", setNet);
    window.addEventListener("offline", setNet);
    setNet();
  </script>
</body>
</html>
